# ÐŸÐ¾ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¸Ðµ Ð°Ð´Ð°Ð¿Ñ‚Ð¸Ð²Ð½Ð¾Ð³Ð¾ ICC-Ð¿Ñ€Ð¾Ñ„Ð¸Ð»Ñ Ð¿Ð¾ Ð´Ð²ÑƒÐ¼ Ñ‚ÐµÐ¼Ð¿ÐµÑ€Ð°Ñ‚ÑƒÑ€Ð°Ð¼

## ðŸ”¹ Ð¨Ð°Ð³ 1. ÐŸÐ¾Ð´Ð³Ð¾Ñ‚Ð¾Ð²ÐºÐ° ÑÑ‚Ð°Ð»Ð¾Ð½Ð° Ð¸ Ð¼Ð¸ÑˆÐµÐ½Ð¸

1. Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ñ‚Ð°Ñ€Ð³ÐµÑ‚ .ti1 Ñ 255 Ð³Ñ€Ð°Ð´Ð°Ñ†Ð¸ÑÐ¼Ð¸ ÑÐµÑ€Ð¾Ð³Ð¾:
   ```bash
   targen -d3 -g255 gray_target
   ```

2. Ð¡Ð³ÐµÐ½ÐµÑ€Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ .ti3:
   ```bash
   printtarg -iCM -h -T gray_target
   colprof -v -qm -D"Gray Ref" gray_target
   ```

3. **Ð˜Ñ‚ÐµÑ€Ð°Ñ‚Ð¸Ð²Ð½Ñ‹Ð¹ Ð¿Ñ€Ð¾Ñ†ÐµÑÑ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð°Ñ†Ð¸Ð¸ ÑÐ»Ð¸Ð¿ÑˆÐ¸Ñ…ÑÑ Ð¿Ð°Ñ‚Ñ‡ÐµÐ¹**:
   ```bash
   python filter_ti3.py gray_target.ti3 gray_filtered.ti1
   printtarg -iCM -h -T gray_filtered
   ```
   - Ð’Ð°Ð¶Ð½Ð¾: ÑÐºÑ€Ð¸Ð¿Ñ‚ Ð¾ÑÑ‚Ð°Ð²Ð»ÑÐµÑ‚ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ñ‚Ðµ Ð¿Ð°Ñ‚Ñ‡Ð¸, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ Ñ€Ð°Ð·Ð»Ð¸Ñ‡Ð¸Ð¼Ñ‹ Ð¿Ð¾ Î”E
   - Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚: Ð¾Ð¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ð°Ñ Ð¼Ð¸ÑˆÐµÐ½ÑŒ Ñ Ñ€Ð°Ð·Ð»Ð¸Ñ‡Ð¸Ð¼Ñ‹Ð¼Ð¸ Ð³Ñ€Ð°Ð´Ð°Ñ†Ð¸ÑÐ¼Ð¸ ÑÐµÑ€Ð¾Ð³Ð¾

4. ÐŸÐµÑ‡Ð°Ñ‚ÑŒ Ð¸ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð½Ð¾Ð³Ð¾ Ñ‚Ð°Ñ€Ð³ÐµÑ‚Ð° Ð´Ð»Ñ Ð´Ð°Ð»ÑŒÐ½ÐµÐ¹ÑˆÐ¸Ñ… ÑˆÐ°Ð³Ð¾Ð².

## ðŸ”¹ Ð¨Ð°Ð³ 2. Ð¦Ð¸Ñ„Ñ€Ð¾Ð²Ð°Ñ ÑÑŠÑ‘Ð¼ÐºÐ° Ð¾Ñ‚Ð¿ÐµÑ‡Ð°Ñ‚Ð°Ð½Ð½Ð¾Ð¹ Ð¼Ð¸ÑˆÐµÐ½Ð¸

1. Ð¡Ð½Ð¸Ð¼Ð°ÐµÐ¼ Ð¿Ñ€Ð¸ 3000K Ð¸ 5000K, Ð² RAW, linear (dcraw).
   - ÐžÑÐ²ÐµÑ‰ÐµÐ½Ð¸Ðµ: CRI â‰¥ 95
   - ÐšÐ°Ð¼ÐµÑ€Ð°: ÑÑŠÑ‘Ð¼ÐºÐ° Ð² RAW, Ñ€ÑƒÑ‡Ð½Ð¾Ð¹ Ñ€ÐµÐ¶Ð¸Ð¼ ÑÐºÑÐ¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¸ Ð¸ Ð‘Ð‘

2. **Ð¡ÑŠÑ‘Ð¼ÐºÐ° Ñ Ð±Ñ€ÐµÐºÐµÑ‚Ð¸Ð½Ð³Ð¾Ð¼ Ð¸ Ð²Ñ‹Ð±Ð¾Ñ€ Ð¾Ð¿Ñ‚Ð¸Ð¼Ð°Ð»ÑŒÐ½Ð¾Ð¹ ÑÐºÑÐ¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¸**:
   - Ð¡ÐµÑ€Ð¸Ñ ÑÐ½Ð¸Ð¼ÐºÐ¾Ð² Ñ Ñ€Ð°Ð·Ð½Ð¾Ð¹ ÑÐºÑÐ¿Ð¾Ð·Ð¸Ñ†Ð¸ÐµÐ¹
   - ÐšÐ¾Ð½Ð²ÐµÑ€Ñ‚Ð°Ñ†Ð¸Ñ Ð±ÐµÐ· Ñ‚Ð¾Ð½Ð¾Ð²Ñ‹Ñ… Ð¿Ñ€ÐµÐ¾Ð±Ñ€Ð°Ð·Ð¾Ð²Ð°Ð½Ð¸Ð¹:
     ```bash
     dcraw -v -T -6 -4 -o 0 -q 3 -W IMG_XXXX.RAW
     ```

3. ÐÐ½Ð°Ð»Ð¸Ð· Ð¸ Ð²Ñ‹Ð±Ð¾Ñ€ Ð¾Ð¿Ñ‚Ð¸Ð¼Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ ÐºÐ°Ð´Ñ€Ð°:
   ```bash
   scanin -v -p -a digital_3000.tif base.cht gray_filtered.ti1
   scanin -v -p -a digital_5000.tif base.cht gray_filtered.ti1
   ```

4. ÐžÑ†ÐµÐ½ÐºÐ° Ñ‚Ð¾Ñ‡Ð½Ð¾ÑÑ‚Ð¸ Ð¿Ð¾ ÐºÑ€Ð¸Ñ‚ÐµÑ€Ð¸ÑÐ¼:
   - Ð¡Ñ€ÐµÐ´Ð½ÐµÐµ âˆ†E (mean DE) - Ð´Ð¾Ð»Ð¶Ð½Ð¾ Ð±Ñ‹Ñ‚ÑŒ Ð½Ð°Ð¸Ð¼ÐµÐ½ÑŒÑˆÐ¸Ð¼
   - ÐœÐ°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½Ð¾Ðµ âˆ†E (max DE) - Ð±ÐµÐ· ÐºÐ°Ñ‚Ð°ÑÑ‚Ñ€Ð¾Ñ„Ð¸Ñ‡ÐµÑÐºÐ¸Ñ… Ð²Ñ‹Ð±Ñ€Ð¾ÑÐ¾Ð²
   - 95-Ð¹ Ð¿ÐµÑ€Ñ†ÐµÐ½Ñ‚Ð¸Ð»ÑŒ (Î”E95%) - Ð½Ðµ Ð´Ð¾Ð»Ð¶ÐµÐ½ Ð²Ñ‹Ñ…Ð¾Ð´Ð¸Ñ‚ÑŒ Ð·Ð° 2.5-3.0

5. ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÐ¼: digital_3000.ti3, digital_5000.ti3 â€” ÑÑ‚Ð°Ð»Ð¾Ð½Ð½Ð°Ñ Ñ€ÐµÐ°ÐºÑ†Ð¸Ñ ÐºÐ°Ð¼ÐµÑ€Ñ‹.

## ðŸ”¹ Ð¨Ð°Ð³ 3. Ð¡ÑŠÑ‘Ð¼ÐºÐ° Ñ‚Ð°Ñ€Ð³ÐµÑ‚Ð° Ð½Ð° Ð¿Ð»Ñ‘Ð½ÐºÑƒ

1. ÐžÐ´Ð¸Ð½ Ð¸ Ñ‚Ð¾Ñ‚ Ð¶Ðµ Ñ‚Ð°Ñ€Ð³ÐµÑ‚ ÑÐ½Ð¸Ð¼Ð°ÐµÐ¼:
   - Ð¿Ñ€Ð¸ 3000K â†’ ÐºÐ°Ð´Ñ€ film_3000K
   - Ð¿Ñ€Ð¸ 5000K â†’ ÐºÐ°Ð´Ñ€ film_5000K

2. **Ð¡ÑŠÑ‘Ð¼ÐºÐ° Ñ Ñ€Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð½Ñ‹Ð¼ Ð±Ñ€ÐµÐºÐµÑ‚Ð¸Ð½Ð³Ð¾Ð¼**:
   - Ð‘Ñ€ÐµÐºÐµÑ‚Ð¸Ð½Ð³ Â±1 EV Ñ ÑˆÐ°Ð³Ð¾Ð¼ 0.5 EV
   - Ð¤Ð¸ÐºÑÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ð°Ñ ÐºÐ°Ð¼ÐµÑ€Ð° Ð¸ ÐºÐ¾Ð¼Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ñ
   - Ð’Ñ‹Ð±Ð¸Ñ€Ð°ÐµÐ¼ Ð»ÑƒÑ‡ÑˆÐ¸Ð¹ ÐºÐ°Ð´Ñ€ Ð¿Ð¾ Ð´ÐµÑ‚Ð°Ð»ÑÐ¼ Ñ‚ÐµÐ½ÐµÐ¹/ÑÐ²ÐµÑ‚Ð¾Ð²

## ðŸ”¹ Ð¨Ð°Ð³ 4. ÐŸÑ€Ð¾ÑÐ²ÐºÐ° Ð¸ Ñ†Ð¸Ñ„Ñ€Ð¾Ð²Ð¾Ð¹ Ð¿ÐµÑ€ÐµÑÑŠÑ‘Ð¼ Ð½ÐµÐ³Ð°Ñ‚Ð¸Ð²Ð¾Ð²

1. ÐŸÑ€Ð¾ÑÐ²ÐºÐ° Ð²ÑÐµÐ¹ ÑÐµÑ€Ð¸Ð¸ Ð² Ð¾Ð´Ð½Ð¾Ð¼ Ð¿Ñ€Ð¾ÑÐ²Ð¸Ñ‚ÐµÐ»Ðµ Ñ Ñ‚Ð¾Ñ‡Ð½Ñ‹Ð¼ ÑÐ¾Ð±Ð»ÑŽÐ´ÐµÐ½Ð¸ÐµÐ¼ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸ Ð¸ Ñ‚ÐµÐ¼Ð¿ÐµÑ€Ð°Ñ‚ÑƒÑ€Ñ‹.

2. ÐŸÐµÑ€ÐµÑÑŠÑ‘Ð¼ÐºÐ° Ð½ÐµÐ³Ð°Ñ‚Ð¸Ð²Ð¾Ð² Ñ Ñ„Ð¸ÐºÑÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¼ white balance (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, D50):
   - ÐžÑÐ²ÐµÑ‰ÐµÐ½Ð¸Ðµ ÑÑ‚Ð°Ð±Ð¸Ð»ÑŒÐ½Ð¾Ðµ, Ð±ÐµÐ· Ð°Ð²Ñ‚Ð¾Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐº
   - ÐšÐ°Ð¼ÐµÑ€Ð°, Ð¼Ð°ÑÑˆÑ‚Ð°Ð± Ð¸ Ñ€Ð°ÐºÑƒÑ€Ñ Ð¸Ð´ÐµÐ½Ñ‚Ð¸Ñ‡Ð½Ñ‹ Ñ†Ð¸Ñ„Ñ€Ð¾Ð²Ð¾Ð¼Ñƒ ÑÑ‚Ð°Ð»Ð¾Ð½Ñƒ

3. ÐšÐ¾Ð½Ð²ÐµÑ€Ñ‚Ð°Ñ†Ð¸Ñ Ð² 16bit TIFF (Ð±ÐµÐ· Ñ‚Ð¾Ð½Ð¾Ð²Ñ‹Ñ… ÐºÑ€Ð¸Ð²Ñ‹Ñ…):
   ```bash
   dcraw -v -T -6 -o 0 -q 3 -W IMG_XXXX.RAW
   ```

4. ÐŸÐµÑ€ÐµÐ¿Ñ€Ð¸Ð²ÑÐ·ÐºÐ° ÑÐµÑ‚ÐºÐ¸ Ð¿Ð°Ñ‚Ñ‡ÐµÐ¹:
   - ÐÐ°ÐºÐ»Ð°Ð´Ñ‹Ð²Ð°ÐµÑ‚ÑÑ Ð¸ÑÑ…Ð¾Ð´Ð½Ð°Ñ ÑÐµÑ‚ÐºÐ° Ð¿Ð°Ñ‚Ñ‡ÐµÐ¹
   - Ð¡ÐµÑ‚ÐºÐ° Ð²Ñ€ÑƒÑ‡Ð½ÑƒÑŽ Ð¿Ð¾Ð´Ð³Ð¾Ð½ÑÐµÑ‚ÑÑ Ð¿Ð¾Ð´ Ð¿Ð°Ñ‚Ñ‡Ð¸ Ð½Ð° Ð½ÐµÐ³Ð°Ñ‚Ð¸Ð²Ðµ
   - Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÑÐµÑ‚ÑÑ Ð¾Ð±Ð½Ð¾Ð²Ð»Ñ‘Ð½Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ ÑÐµÑ‚ÐºÐ¸ (.cht)

5. ÐÐ½Ð°Ð»Ð¸Ð· Ð¸ Ð²Ñ‹Ð±Ð¾Ñ€ Ð¾Ð¿Ñ‚Ð¸Ð¼Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ ÐºÐ°Ð´Ñ€Ð°:
   ```bash
   scanin -v -p -a film_3000K.tif corrected.cht gray_filtered.ti1
   scanin -v -p -a film_5000K.tif corrected.cht gray_filtered.ti1
   ```

6. Ð’Ñ‹Ð±Ð¾Ñ€ Ð»ÑƒÑ‡ÑˆÐµÐ³Ð¾ ÐºÐ°Ð´Ñ€Ð° Ð´Ð»Ñ ÐºÐ°Ð¶Ð´Ð¾Ð¹ Ñ‚ÐµÐ¼Ð¿ÐµÑ€Ð°Ñ‚ÑƒÑ€Ñ‹ Ð¿Ð¾ ÐºÑ€Ð¸Ñ‚ÐµÑ€Ð¸ÑÐ¼:
   - ÐœÐ¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ð¾Ðµ ÑÑ€ÐµÐ´Ð½ÐµÐµ Ð¾Ñ‚ÐºÐ»Ð¾Ð½ÐµÐ½Ð¸Ðµ (mean âˆ†E)
   - ÐžÑ‚ÑÑƒÑ‚ÑÑ‚Ð²Ð¸Ðµ ÐºÐ°Ñ‚Ð°ÑÑ‚Ñ€Ð¾Ñ„Ð¸Ñ‡ÐµÑÐºÐ¸Ñ… Ð²Ñ‹Ð±Ñ€Ð¾ÑÐ¾Ð² (max âˆ†E)

## ðŸ”¹ Ð¨Ð°Ð³ 5. ÐŸÐ¾ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¸Ðµ ICC-Ð¿Ñ€Ð¾Ñ„Ð¸Ð»ÐµÐ¹ Ð¿Ð¾ Ð´Ð²ÑƒÐ¼ Ñ‚ÐµÐ¼Ð¿ÐµÑ€Ð°Ñ‚ÑƒÑ€Ð°Ð¼

1. ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ .ti3:
   - film_3000K.ti3
   - film_5000K.ti3

2. Ð“ÐµÐ½ÐµÑ€Ð¸Ñ€ÑƒÐµÐ¼ Ð´Ð²Ð° Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½Ñ‹Ñ… ICC:
   ```bash
   colprof -v -qm -al -D"Neg 3000K" film_3000K
   colprof -v -qm -al -D"Neg 5000K" film_5000K
   ```

## ðŸ”¹ Ð¨Ð°Ð³ 6. Ð¡Ð±Ð¾Ñ€ÐºÐ° Ð¾Ð±ÑŠÐµÐ´Ð¸Ð½Ñ‘Ð½Ð½Ð¾Ð³Ð¾ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»Ñ

1. ÐžÐ±ÑŠÐµÐ´Ð¸Ð½ÑÐµÐ¼ .ti3 Ð² ÐµÐ´Ð¸Ð½Ñ‹Ð¹ Ñ„Ð°Ð¹Ð»: neg_all.ti3
   - Ð¡Ñ‚Ð°Ð²Ð¸Ð¼ Ð¼ÐµÑ‚ÐºÑƒ Ñ‚ÐµÐ¼Ð¿ÐµÑ€Ð°Ñ‚ÑƒÑ€Ñ‹ Ð²Ñ€ÑƒÑ‡Ð½ÑƒÑŽ (Ð² Ð¿Ð¾Ð»Ðµ COMMENT Ð¸Ð»Ð¸ Ð² Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½ÑƒÑŽ ÐºÐ¾Ð»Ð¾Ð½ÐºÑƒ)

2. ÐŸÐ¸ÑˆÐµÐ¼ Python-ÑÐºÑ€Ð¸Ð¿Ñ‚, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹:
   - Ð§Ð¸Ñ‚Ð°ÐµÑ‚ neg_all.ti3
   - Ð˜Ð½Ñ‚ÐµÑ€Ð¿Ð¾Ð»Ð¸Ñ€ÑƒÐµÑ‚ Lab-Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ Ð¿Ð¾ Ñ‚ÐµÐ¼Ð¿ÐµÑ€Ð°Ñ‚ÑƒÑ€Ðµ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, Ñ‡ÐµÑ€ÐµÐ· interp1d)
   - ÐŸÐ¾ Ð·Ð°Ð´Ð°Ð½Ð½Ð¾Ð¹ Ñ†ÐµÐ»ÐµÐ²Ð¾Ð¹ Ñ‚ÐµÐ¼Ð¿ÐµÑ€Ð°Ñ‚ÑƒÑ€Ðµ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, target_temp = 4000) Ð²Ñ‹Ð´Ð°Ñ‘Ñ‚ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð¸Ñ€ÑƒÑŽÑ‰Ð¸Ð¹ .ti3

3. Ð“ÐµÐ½ÐµÑ€Ð¸Ñ€ÑƒÐµÐ¼ Ð¸Ñ‚Ð¾Ð³Ð¾Ð²Ñ‹Ð¹ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»ÑŒ:
   ```bash
   colprof -v -qm -al -D"Adaptive BW Neg Profile" neg_interp
   ```

4. ÐžÐ¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾: Ð¸Ð½Ñ‚ÐµÑ€Ð¿Ð¾Ð»ÑÑ†Ð¸Ñ Ð¿Ñ€Ð¾Ð¼ÐµÐ¶ÑƒÑ‚Ð¾Ñ‡Ð½Ñ‹Ñ… Ñ‚ÐµÐ¼Ð¿ÐµÑ€Ð°Ñ‚ÑƒÑ€
   ```bash
   # ÐŸÑ€Ð¸Ð¼ÐµÑ€ Ð¸Ð½Ñ‚ÐµÑ€Ð¿Ð¾Ð»ÑÑ†Ð¸Ð¸ Ð² ÑÐµÑ€ÐµÐ´Ð¸Ð½Ñƒ (0.5 Ð¼ÐµÐ¶Ð´Ñƒ 3000 Ð¸ 5000K)
   ti3_interp -v -i film_3000K.ti3 film_5000K.ti3 0.5 > film_4000K.ti3
   ```